import { __decorate } from "tslib";
import { Component, Input, HostBinding, ViewChild } from '@angular/core';
import { EventService } from './event.service';
import { Utils } from './utils';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from './event.service';

var _c0 = ["imageFirst"];
var _c1 = ["imageSecond"];
var _c2 = ["imageLast"];
var _c3 = ["lightboxImage"];
var LightboxCommonComponent = /** @class */ (function () {
    function LightboxCommonComponent(eventService) {
        this.eventService = eventService;
        this.currentImageIndex = 0;
        this.indexCurrentSlide = 1;
        this.containerStyles = {
            transition: '',
            transform: '',
            width: '',
            height: '',
            opacity: ''
        };
        this.currImageLoadingState = 'not-loaded';
        this.isMobile = Utils.mobileCheck();
    }
    Object.defineProperty(LightboxCommonComponent.prototype, "lightboxImage", {
        get: function () {
            return this._lightboxImage;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "lightboxImageElement", {
        get: function () {
            if (this.lightboxImage) {
                return this.lightboxImage.nativeElement;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "lightboxImageNaturalHeight", {
        get: function () {
            if (this.lightboxImageElement) {
                return this.lightboxImageElement.naturalHeight;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "lightboxImageNaturalWidth", {
        get: function () {
            if (this.lightboxImageElement) {
                return this.lightboxImageElement.naturalWidth;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "index", {
        get: function () {
            return this.currentImageIndex;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "properties", {
        get: function () {
            return this.lightboxData.properties;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "images", {
        get: function () {
            return this.lightboxData.images || [this.lightboxData.image];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "thumbnailImage", {
        get: function () {
            return this.images[this.currentImageIndex].nativeElement;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "thumbnailImagePosition", {
        get: function () {
            return this.thumbnailImage.getBoundingClientRect();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "virtualImageDimension", {
        // Image size if it is larger than the window size
        get: function () {
            var height = this.lightboxImageNaturalHeight;
            var width = height * this.imageAspectRatio;
            var windowWidth = document.body.clientWidth;
            var windowHeight = window.innerHeight;
            if (this.isImageLargerWindow) {
                if (height > windowHeight) {
                    height = windowHeight;
                    width = height * this.imageAspectRatio;
                }
                if (width > windowWidth) {
                    width = windowWidth;
                    height = width / this.imageAspectRatio;
                }
            }
            else {
                width = this.lightboxImageNaturalWidth;
                height = this.lightboxImageNaturalHeight;
            }
            if (width === 0 || Number.parseInt(height) === 0) {
                return { width: 200, height: 200 };
            }
            return { width: width, height: height };
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "containerInitialPosition", {
        get: function () {
            var scale = (this.showState === 'initial-thumbnail-image') ? 1 : this.containerScale;
            var top = this.thumbnailImagePosition.top;
            var left = this.thumbnailImagePosition.left;
            return 'matrix(' + scale + ', 0, 0, ' + scale + ',' + left + ',' + top + ')';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "containerFullscreenPosition", {
        get: function () {
            var left = (document.body.clientWidth - this.virtualImageDimension.width) / 2;
            var top = (window.innerHeight - this.virtualImageDimension.height) / 2;
            return 'translate3d(' + left + 'px, ' + top + 'px, 0)';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "containerScale", {
        get: function () {
            return this.thumbnailImagePosition.width / this.virtualImageDimension.width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "imageAspectRatio", {
        get: function () {
            return this.thumbnailImage.naturalWidth / this.thumbnailImage.naturalHeight;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "isImageLargerWindow", {
        get: function () {
            var imageNaturalWidth = this.lightboxImageNaturalWidth;
            var imageNaturalHeight = this.lightboxImageNaturalHeight;
            var windowWidth = document.body.clientWidth;
            var windowHeight = window.innerHeight;
            return imageNaturalWidth > windowWidth || imageNaturalHeight > windowHeight;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "isFirstImage", {
        get: function () {
            if (this.properties.loop) {
                return false;
            }
            else {
                return this.index === 0;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "isLastImage", {
        get: function () {
            if (this.properties.loop) {
                return false;
            }
            else {
                return this.index === this.latestImageIndex;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "latestImageIndex", {
        get: function () {
            return this.images.length - 1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "backgroundColor", {
        get: function () {
            var opacity = this.properties.backgroundOpacity;
            var color = this.properties.backgroundColor;
            if (color === 'black') {
                return 'rgba(0, 0, 0, ' + opacity + ')';
            }
            else {
                return 'rgba(255, 255, 255, ' + opacity + ')';
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "animationDuration", {
        get: function () {
            var animationDuration = this.properties.animationDuration;
            if (typeof animationDuration === "string") {
                return Number.parseInt(animationDuration);
            }
            else {
                return animationDuration;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "animationMode", {
        get: function () {
            if (this.currImageLoadingState === 'error') {
                return 'default';
            }
            return this.properties.animationMode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "animationTimingFunction", {
        get: function () {
            return this.properties.animationTimingFunction;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "closeButtonText", {
        get: function () {
            return this.properties.closeButtonText;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "counterSeparator", {
        get: function () {
            return this.properties.counterSeparator;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightboxCommonComponent.prototype, "counter", {
        get: function () {
            return this.currentImageIndex + 1 + this.counterSeparator + this.images.length;
        },
        enumerable: true,
        configurable: true
    });
    LightboxCommonComponent.prototype.emitState = function (type, state) {
        if (state === 'initial-virtual-image' ||
            state === 'initial-styles') {
            return;
        }
        if (state === 'initial-default' ||
            state === 'initial-thumbnail-image') {
            state = 'initial';
        }
        this.eventService.emitChangeEvent({
            type: type + ':' + state
        });
    };
    LightboxCommonComponent.prototype.setShowState = function (state) {
        this.showState = state;
        this.emitState('show-state', state);
    };
    LightboxCommonComponent.prototype.setClosingState = function (state) {
        this.closingState = state;
        this.emitState('closing-state', state);
    };
    LightboxCommonComponent.prototype.setAnimationDuration = function () {
        this.hostStyleTransition = 'background-color ' + this.animationDuration + 'ms';
        this.containerStyles.transition = 'all ' + this.animationDuration + 'ms ' + this.animationTimingFunction;
    };
    LightboxCommonComponent.prototype.setBackgroundColor = function () {
        this.hostStyleBackgroundColor = this.backgroundColor;
    };
    LightboxCommonComponent.prototype.getContainerHeight = function () {
        return this.thumbnailImagePosition.height / this.containerScale + 'px';
    };
    LightboxCommonComponent.prototype.showThumbnailImage = function () {
        this.thumbnailImage.style.opacity = '';
    };
    LightboxCommonComponent.prototype.hideThumbnailImage = function () {
        this.thumbnailImage.style.opacity = 0;
    };
    LightboxCommonComponent.prototype.updateThumbnailPosition = function () {
        this.containerStyles.transform = this.containerInitialPosition;
    };
    LightboxCommonComponent.ctorParameters = function () { return [
        { type: EventService }
    ]; };
    __decorate([
        Input()
    ], LightboxCommonComponent.prototype, "lightboxData", void 0);
    __decorate([
        HostBinding('style.backgroundColor')
    ], LightboxCommonComponent.prototype, "hostStyleBackgroundColor", void 0);
    __decorate([
        HostBinding('style.transition')
    ], LightboxCommonComponent.prototype, "hostStyleTransition", void 0);
    __decorate([
        ViewChild('imageFirst', { static: true })
    ], LightboxCommonComponent.prototype, "_imageFirst", void 0);
    __decorate([
        ViewChild('imageSecond', { static: true })
    ], LightboxCommonComponent.prototype, "_imageSecond", void 0);
    __decorate([
        ViewChild('imageLast', { static: true })
    ], LightboxCommonComponent.prototype, "_imageLast", void 0);
    __decorate([
        ViewChild('lightboxImage', { static: true })
    ], LightboxCommonComponent.prototype, "_lightboxImage", void 0);
LightboxCommonComponent.ɵfac = function LightboxCommonComponent_Factory(t) { return new (t || LightboxCommonComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.EventService)); };
LightboxCommonComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: LightboxCommonComponent, selectors: [["lightbox-common"]], viewQuery: function LightboxCommonComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c0, 3);
        ɵngcc0.ɵɵviewQuery(_c1, 3);
        ɵngcc0.ɵɵviewQuery(_c2, 3);
        ɵngcc0.ɵɵviewQuery(_c3, 3);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx._imageFirst = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx._imageSecond = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx._imageLast = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx._lightboxImage = _t.first);
    } }, hostVars: 4, hostBindings: function LightboxCommonComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵstyleProp("transition", ctx.hostStyleTransition)("background-color", ctx.hostStyleBackgroundColor);
    } }, inputs: { lightboxData: "lightboxData" }, decls: 0, vars: 0, template: function LightboxCommonComponent_Template(rf, ctx) { }, encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(LightboxCommonComponent, [{
        type: Component,
        args: [{
                selector: 'lightbox-common',
                template: ''
            }]
    }], function () { return [{ type: ɵngcc1.EventService }]; }, { hostStyleTransition: [{
            type: HostBinding,
            args: ['style.transition']
        }], hostStyleBackgroundColor: [{
            type: HostBinding,
            args: ['style.backgroundColor']
        }], lightboxData: [{
            type: Input
        }], _imageFirst: [{
            type: ViewChild,
            args: ['imageFirst', { static: true }]
        }], _imageSecond: [{
            type: ViewChild,
            args: ['imageSecond', { static: true }]
        }], _imageLast: [{
            type: ViewChild,
            args: ['imageLast', { static: true }]
        }], _lightboxImage: [{
            type: ViewChild,
            args: ['lightboxImage', { static: true }]
        }] }); })();
    return LightboxCommonComponent;
}());
export { LightboxCommonComponent };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlnaHRib3gtY29tbW9uLmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiQGNyeXN0YWx1aS9hbmd1bGFyLWxpZ2h0Ym94L2xpYi9saWdodGJveC1jb21tb24uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFjLE1BQU0sZUFBZSxDQUFDO0FBR3JGLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sU0FBUyxDQUFDOzs7Ozs7OztBQU9oQztBQUVvQixJQTRMaEIsaUNBQW1CLFlBQTBCO0FBQy9DLFFBRHFCLGlCQUFZLEdBQVosWUFBWSxDQUFjO0FBQUUsUUE1TC9DLHNCQUFpQixHQUFXLENBQUMsQ0FBQztBQUNqQyxRQUFHLHNCQUFpQixHQUFHLENBQUMsQ0FBQztBQUN6QixRQUVHLG9CQUFlLEdBQVE7QUFDMUIsWUFBTyxVQUFVLEVBQUUsRUFBRTtBQUNyQixZQUFPLFNBQVMsRUFBRSxFQUFFO0FBQ3BCLFlBQU8sS0FBSyxFQUFFLEVBQUU7QUFDaEIsWUFBTyxNQUFNLEVBQUUsRUFBRTtBQUNqQixZQUFPLE9BQU8sRUFBRSxFQUFFO0FBQ2xCLFNBQUksQ0FBQztBQUNMLFFBQUcsMEJBQXFCLEdBQW9ELFlBQVksQ0FBQztBQUN6RixRQWlMTyxJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxXQUFXLEVBQUUsQ0FBQztBQUMzQyxJQUFHLENBQUM7QUFFTCxJQXhLSSxzQkFBSSxrREFBYTtBQUNwQixhQURHO0FBQWUsWUFDWCxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUM7QUFDbEMsUUFBRyxDQUFDO0FBRUo7QUFBMkI7QUFDSixPQUhuQjtBQUVMLElBQUksc0JBQUkseURBQW9CO0FBQzNCLGFBREc7QUFBZSxZQUNYLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBQztBQUM5Qixn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QUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUdBLEFBQUEsQUFBQSxBQURBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQU1BLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQXJEQSxBQUFBLEFBOUtBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUF4QkEsQUFBQSxBQUxBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQW9QQSxBQUFBLEFBQUEsQUFBQSxBQXBQQSxBQW9QQSxBQXBQQSxBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgSG9zdEJpbmRpbmcsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTGlnaHRib3hEYXRhLCBQcm9wZXJ0aWVzIH0gZnJvbSAnLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7IFNob3dTdGF0ZSwgQ2xvc2luZ1N0YXRlIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBFdmVudFNlcnZpY2UgfSBmcm9tICcuL2V2ZW50LnNlcnZpY2UnO1xuaW1wb3J0IHsgVXRpbHMgfSBmcm9tICcuL3V0aWxzJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdsaWdodGJveC1jb21tb24nLFxuICAgIHRlbXBsYXRlOiAnJ1xufSlcblxuZXhwb3J0IGNsYXNzIExpZ2h0Ym94Q29tbW9uQ29tcG9uZW50IHtcblxuICAgIGN1cnJlbnRJbWFnZUluZGV4OiBudW1iZXIgPSAwO1xuICAgIGluZGV4Q3VycmVudFNsaWRlID0gMTtcbiAgICBzaG93U3RhdGU6IFNob3dTdGF0ZTtcbiAgICBjbG9zaW5nU3RhdGU6IENsb3NpbmdTdGF0ZTtcbiAgICBjb250YWluZXJTdHlsZXM6IGFueSA9IHtcbiAgICAgICAgdHJhbnNpdGlvbjogJycsXG4gICAgICAgIHRyYW5zZm9ybTogJycsXG4gICAgICAgIHdpZHRoOiAnJyxcbiAgICAgICAgaGVpZ2h0OiAnJyxcbiAgICAgICAgb3BhY2l0eTogJydcbiAgICB9O1xuICAgIGN1cnJJbWFnZUxvYWRpbmdTdGF0ZTogJ25vdC1sb2FkZWQnIHwgJ2xvYWRpbmcnIHwgJ3VwbG9hZGVkJyB8ICdlcnJvcicgPSAnbm90LWxvYWRlZCc7XG4gICAgaXNNb2JpbGU6IGJvb2xlYW47XG5cbiAgICBASW5wdXQoKSBsaWdodGJveERhdGE6IExpZ2h0Ym94RGF0YTtcblxuICAgIEBIb3N0QmluZGluZygnc3R5bGUuYmFja2dyb3VuZENvbG9yJykgaG9zdFN0eWxlQmFja2dyb3VuZENvbG9yOiBzdHJpbmc7XG4gICAgQEhvc3RCaW5kaW5nKCdzdHlsZS50cmFuc2l0aW9uJykgaG9zdFN0eWxlVHJhbnNpdGlvbjogc3RyaW5nO1xuXG4gICAgQFZpZXdDaGlsZCgnaW1hZ2VGaXJzdCcsIHsgc3RhdGljOiB0cnVlIH0pIF9pbWFnZUZpcnN0OiBFbGVtZW50UmVmO1xuICAgIEBWaWV3Q2hpbGQoJ2ltYWdlU2Vjb25kJywgeyBzdGF0aWM6IHRydWUgfSkgX2ltYWdlU2Vjb25kOiBFbGVtZW50UmVmO1xuICAgIEBWaWV3Q2hpbGQoJ2ltYWdlTGFzdCcsIHsgc3RhdGljOiB0cnVlIH0pIF9pbWFnZUxhc3Q6IEVsZW1lbnRSZWY7XG4gICAgQFZpZXdDaGlsZCgnbGlnaHRib3hJbWFnZScsIHsgc3RhdGljOiB0cnVlIH0pIF9saWdodGJveEltYWdlOiBFbGVtZW50UmVmO1xuXG4gICAgZ2V0IGxpZ2h0Ym94SW1hZ2UoKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xpZ2h0Ym94SW1hZ2U7XG4gICAgfVxuXG4gICAgZ2V0IGxpZ2h0Ym94SW1hZ2VFbGVtZW50KCl7XG4gICAgICAgIGlmICh0aGlzLmxpZ2h0Ym94SW1hZ2Upe1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGlnaHRib3hJbWFnZS5uYXRpdmVFbGVtZW50O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IGxpZ2h0Ym94SW1hZ2VOYXR1cmFsSGVpZ2h0KCl7XG4gICAgICAgIGlmICh0aGlzLmxpZ2h0Ym94SW1hZ2VFbGVtZW50KXtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxpZ2h0Ym94SW1hZ2VFbGVtZW50Lm5hdHVyYWxIZWlnaHQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgbGlnaHRib3hJbWFnZU5hdHVyYWxXaWR0aCgpe1xuICAgICAgICBpZiAodGhpcy5saWdodGJveEltYWdlRWxlbWVudCl7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5saWdodGJveEltYWdlRWxlbWVudC5uYXR1cmFsV2lkdGg7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgaW5kZXgoKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudEltYWdlSW5kZXg7XG4gICAgfVxuXG4gICAgZ2V0IHByb3BlcnRpZXMoKXtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlnaHRib3hEYXRhLnByb3BlcnRpZXM7XG4gICAgfVxuXG4gICAgZ2V0IGltYWdlcygpe1xuICAgICAgICByZXR1cm4gdGhpcy5saWdodGJveERhdGEuaW1hZ2VzIHx8IFt0aGlzLmxpZ2h0Ym94RGF0YS5pbWFnZV07XG4gICAgfVxuXG4gICAgZ2V0IHRodW1ibmFpbEltYWdlKCl7XG4gICAgICAgIHJldHVybiB0aGlzLmltYWdlc1t0aGlzLmN1cnJlbnRJbWFnZUluZGV4XS5uYXRpdmVFbGVtZW50O1xuICAgIH1cblxuICAgIGdldCB0aHVtYm5haWxJbWFnZVBvc2l0aW9uKCl7XG4gICAgICAgIHJldHVybiB0aGlzLnRodW1ibmFpbEltYWdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIH1cblxuICAgIC8vIEltYWdlIHNpemUgaWYgaXQgaXMgbGFyZ2VyIHRoYW4gdGhlIHdpbmRvdyBzaXplXG4gICAgZ2V0IHZpcnR1YWxJbWFnZURpbWVuc2lvbigpe1xuICAgICAgICBsZXQgaGVpZ2h0ID0gdGhpcy5saWdodGJveEltYWdlTmF0dXJhbEhlaWdodDtcbiAgICAgICAgbGV0IHdpZHRoID0gaGVpZ2h0ICogdGhpcy5pbWFnZUFzcGVjdFJhdGlvO1xuICAgICAgICBjb25zdCB3aW5kb3dXaWR0aCA9IGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGg7XG4gICAgICAgIGNvbnN0IHdpbmRvd0hlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcblxuICAgICAgICBpZiAodGhpcy5pc0ltYWdlTGFyZ2VyV2luZG93KXtcbiAgICAgICAgICAgIGlmIChoZWlnaHQgPiB3aW5kb3dIZWlnaHQpe1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IHdpbmRvd0hlaWdodDtcbiAgICAgICAgICAgICAgICB3aWR0aCA9IGhlaWdodCAqIHRoaXMuaW1hZ2VBc3BlY3RSYXRpbztcbiAgICAgICAgICAgIH0gXG5cbiAgICAgICAgICAgIGlmICh3aWR0aCA+IHdpbmRvd1dpZHRoKXtcbiAgICAgICAgICAgICAgICB3aWR0aCA9IHdpbmRvd1dpZHRoO1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoIC8gdGhpcy5pbWFnZUFzcGVjdFJhdGlvO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgd2lkdGggPSB0aGlzLmxpZ2h0Ym94SW1hZ2VOYXR1cmFsV2lkdGg7XG4gICAgICAgICAgICBoZWlnaHQgPSB0aGlzLmxpZ2h0Ym94SW1hZ2VOYXR1cmFsSGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHdpZHRoID09PSAwIHx8IE51bWJlci5wYXJzZUludChoZWlnaHQpID09PSAwKXtcbiAgICAgICAgICAgIHJldHVybiB7d2lkdGg6IDIwMCwgaGVpZ2h0OiAyMDB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHt3aWR0aCwgaGVpZ2h0fTtcbiAgICB9XG5cbiAgICBnZXQgY29udGFpbmVySW5pdGlhbFBvc2l0aW9uKCl7XG4gICAgICAgIGNvbnN0IHNjYWxlID0gICh0aGlzLnNob3dTdGF0ZSA9PT0gJ2luaXRpYWwtdGh1bWJuYWlsLWltYWdlJykgPyAxIDogdGhpcy5jb250YWluZXJTY2FsZTsgXG4gICAgICAgIGNvbnN0IHRvcCA9IHRoaXMudGh1bWJuYWlsSW1hZ2VQb3NpdGlvbi50b3A7XG4gICAgICAgIGNvbnN0IGxlZnQgPSB0aGlzLnRodW1ibmFpbEltYWdlUG9zaXRpb24ubGVmdDtcbiAgICAgICAgcmV0dXJuICdtYXRyaXgoJysgc2NhbGUgKycsIDAsIDAsICcrIHNjYWxlICsnLCcrIGxlZnQgKycsJysgdG9wICsnKSc7XG4gICAgfVxuXG4gICAgZ2V0IGNvbnRhaW5lckZ1bGxzY3JlZW5Qb3NpdGlvbigpe1xuICAgICAgICBjb25zdCBsZWZ0ID0gKGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGggLSB0aGlzLnZpcnR1YWxJbWFnZURpbWVuc2lvbi53aWR0aCkgLyAyO1xuICAgICAgICBjb25zdCB0b3AgPSAod2luZG93LmlubmVySGVpZ2h0IC0gdGhpcy52aXJ0dWFsSW1hZ2VEaW1lbnNpb24uaGVpZ2h0KSAvIDI7XG5cbiAgICAgICAgcmV0dXJuICd0cmFuc2xhdGUzZCgnKyBsZWZ0ICsncHgsICcrIHRvcCArJ3B4LCAwKSc7XG4gICAgfVxuXG4gICAgZ2V0IGNvbnRhaW5lclNjYWxlKCl7XG4gICAgICAgIHJldHVybiB0aGlzLnRodW1ibmFpbEltYWdlUG9zaXRpb24ud2lkdGggLyB0aGlzLnZpcnR1YWxJbWFnZURpbWVuc2lvbi53aWR0aDtcbiAgICB9XG5cbiAgICBnZXQgaW1hZ2VBc3BlY3RSYXRpbygpe1xuICAgICAgICByZXR1cm4gdGhpcy50aHVtYm5haWxJbWFnZS5uYXR1cmFsV2lkdGggLyB0aGlzLnRodW1ibmFpbEltYWdlLm5hdHVyYWxIZWlnaHQ7XG4gICAgfVxuXG4gICAgZ2V0IGlzSW1hZ2VMYXJnZXJXaW5kb3coKTpib29sZWFuIHtcbiAgICAgICAgY29uc3QgaW1hZ2VOYXR1cmFsV2lkdGggPSB0aGlzLmxpZ2h0Ym94SW1hZ2VOYXR1cmFsV2lkdGg7XG4gICAgICAgIGNvbnN0IGltYWdlTmF0dXJhbEhlaWdodCA9IHRoaXMubGlnaHRib3hJbWFnZU5hdHVyYWxIZWlnaHQ7XG4gICAgICAgIGNvbnN0IHdpbmRvd1dpZHRoID0gZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDtcbiAgICAgICAgY29uc3Qgd2luZG93SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgICAgICByZXR1cm4gaW1hZ2VOYXR1cmFsV2lkdGggPiB3aW5kb3dXaWR0aCB8fCBpbWFnZU5hdHVyYWxIZWlnaHQgPiB3aW5kb3dIZWlnaHQ7XG4gICAgfVxuXG4gICAgZ2V0IGlzRmlyc3RJbWFnZSgpe1xuICAgICAgICBpZiAodGhpcy5wcm9wZXJ0aWVzLmxvb3Ape1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXggPT09IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgaXNMYXN0SW1hZ2UoKXtcbiAgICAgICAgaWYgKHRoaXMucHJvcGVydGllcy5sb29wKXtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmluZGV4ID09PSB0aGlzLmxhdGVzdEltYWdlSW5kZXg7XG4gICAgICAgIH0gICAgICAgIFxuICAgIH1cblxuICAgIGdldCBsYXRlc3RJbWFnZUluZGV4KCl7XG4gICAgICAgIHJldHVybiB0aGlzLmltYWdlcy5sZW5ndGggLSAxO1xuICAgIH1cblxuICAgIGdldCBiYWNrZ3JvdW5kQ29sb3IoKXtcbiAgICAgICAgY29uc3Qgb3BhY2l0eSA9IHRoaXMucHJvcGVydGllcy5iYWNrZ3JvdW5kT3BhY2l0eTtcbiAgICAgICAgY29uc3QgY29sb3IgPSB0aGlzLnByb3BlcnRpZXMuYmFja2dyb3VuZENvbG9yO1xuICAgICAgICBpZiAoY29sb3IgPT09ICdibGFjaycpIHtcbiAgICAgICAgICAgIHJldHVybiAncmdiYSgwLCAwLCAwLCAnICsgb3BhY2l0eSArJyknO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICdyZ2JhKDI1NSwgMjU1LCAyNTUsICcgKyBvcGFjaXR5ICsnKSc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgYW5pbWF0aW9uRHVyYXRpb24oKXtcbiAgICAgICAgY29uc3QgYW5pbWF0aW9uRHVyYXRpb24gPSB0aGlzLnByb3BlcnRpZXMuYW5pbWF0aW9uRHVyYXRpb247XG5cbiAgICAgICAgaWYgKHR5cGVvZiBhbmltYXRpb25EdXJhdGlvbiA9PT0gXCJzdHJpbmdcIil7XG4gICAgICAgICAgICByZXR1cm4gTnVtYmVyLnBhcnNlSW50KGFuaW1hdGlvbkR1cmF0aW9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBhbmltYXRpb25EdXJhdGlvbjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBhbmltYXRpb25Nb2RlKCl7XG4gICAgICAgIGlmICh0aGlzLmN1cnJJbWFnZUxvYWRpbmdTdGF0ZSA9PT0gJ2Vycm9yJyl7XG4gICAgICAgICAgICByZXR1cm4gJ2RlZmF1bHQnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuYW5pbWF0aW9uTW9kZTtcbiAgICB9XG5cbiAgICBnZXQgYW5pbWF0aW9uVGltaW5nRnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5hbmltYXRpb25UaW1pbmdGdW5jdGlvbjtcbiAgICB9XG5cbiAgICBnZXQgY2xvc2VCdXR0b25UZXh0KCl7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuY2xvc2VCdXR0b25UZXh0O1xuICAgIH1cblxuICAgIGdldCBjb3VudGVyU2VwYXJhdG9yKCl7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuY291bnRlclNlcGFyYXRvcjtcbiAgICB9XG5cbiAgICBnZXQgY291bnRlcigpe1xuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50SW1hZ2VJbmRleCArIDEgKyB0aGlzLmNvdW50ZXJTZXBhcmF0b3IgKyB0aGlzLmltYWdlcy5sZW5ndGg7XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IocHVibGljIGV2ZW50U2VydmljZTogRXZlbnRTZXJ2aWNlKXtcbiAgICAgICAgdGhpcy5pc01vYmlsZSA9IFV0aWxzLm1vYmlsZUNoZWNrKCk7XG4gICAgfVxuXG4gICAgZW1pdFN0YXRlKHR5cGUsIHN0YXRlKXtcbiAgICAgICAgaWYgKHN0YXRlID09PSAnaW5pdGlhbC12aXJ0dWFsLWltYWdlJyB8fCBcbiAgICAgICAgICAgIHN0YXRlID09PSAnaW5pdGlhbC1zdHlsZXMnKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzdGF0ZSA9PT0gJ2luaXRpYWwtZGVmYXVsdCcgfHwgXG4gICAgICAgICAgICBzdGF0ZSA9PT0gJ2luaXRpYWwtdGh1bWJuYWlsLWltYWdlJyl7XG4gICAgICAgICAgICBzdGF0ZSA9ICdpbml0aWFsJztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZXZlbnRTZXJ2aWNlLmVtaXRDaGFuZ2VFdmVudCh7XG4gICAgICAgICAgICB0eXBlOiB0eXBlKyc6JytzdGF0ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZXRTaG93U3RhdGUoc3RhdGU6IFNob3dTdGF0ZSl7XG4gICAgICAgIHRoaXMuc2hvd1N0YXRlID0gc3RhdGU7XG4gICAgICAgIHRoaXMuZW1pdFN0YXRlKCdzaG93LXN0YXRlJywgc3RhdGUpXG4gICAgfVxuXG4gICAgc2V0Q2xvc2luZ1N0YXRlKHN0YXRlOiBDbG9zaW5nU3RhdGUpe1xuICAgICAgICB0aGlzLmNsb3NpbmdTdGF0ZSA9IHN0YXRlOyBcbiAgICAgICAgdGhpcy5lbWl0U3RhdGUoJ2Nsb3Npbmctc3RhdGUnLCBzdGF0ZSk7XG4gICAgfVxuXG4gICAgc2V0QW5pbWF0aW9uRHVyYXRpb24oKXtcbiAgICAgICAgdGhpcy5ob3N0U3R5bGVUcmFuc2l0aW9uID0gJ2JhY2tncm91bmQtY29sb3IgJyt0aGlzLmFuaW1hdGlvbkR1cmF0aW9uKydtcyc7XG4gICAgICAgIHRoaXMuY29udGFpbmVyU3R5bGVzLnRyYW5zaXRpb24gPSAnYWxsICcrdGhpcy5hbmltYXRpb25EdXJhdGlvbisnbXMgJyt0aGlzLmFuaW1hdGlvblRpbWluZ0Z1bmN0aW9uO1xuICAgIH1cblxuICAgIHNldEJhY2tncm91bmRDb2xvcigpe1xuICAgICAgICB0aGlzLmhvc3RTdHlsZUJhY2tncm91bmRDb2xvciA9IHRoaXMuYmFja2dyb3VuZENvbG9yO1xuICAgIH1cblxuICAgIGdldENvbnRhaW5lckhlaWdodCgpOnN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLnRodW1ibmFpbEltYWdlUG9zaXRpb24uaGVpZ2h0IC8gdGhpcy5jb250YWluZXJTY2FsZSArICdweCc7XG4gICAgfVxuXG4gICAgc2hvd1RodW1ibmFpbEltYWdlKCkge1xuICAgICAgICB0aGlzLnRodW1ibmFpbEltYWdlLnN0eWxlLm9wYWNpdHkgPSAnJztcbiAgICB9XG5cbiAgICBoaWRlVGh1bWJuYWlsSW1hZ2UoKXtcbiAgICAgICAgdGhpcy50aHVtYm5haWxJbWFnZS5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgICB9XG5cbiAgICB1cGRhdGVUaHVtYm5haWxQb3NpdGlvbigpe1xuICAgICAgICB0aGlzLmNvbnRhaW5lclN0eWxlcy50cmFuc2Zvcm0gPSB0aGlzLmNvbnRhaW5lckluaXRpYWxQb3NpdGlvbjtcbiAgICB9XG59IFxuIl19